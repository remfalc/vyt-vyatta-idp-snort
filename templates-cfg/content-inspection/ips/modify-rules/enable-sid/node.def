multi:

type: txt

syntax:expression: pattern $VAR(@) "^[0-9]+\:?[0-9]*$" ; "invalid gid:sid \"$VAR(@)\""

help: Set Snort ID (sid) to enable

comp_help: possible completions:
  [<gid>:]<sid>    Set sid to enable (gid defaults to 1)

create: sudo ${vyatta_sbindir}/vyatta-modify-sids.pl        \
                 --action=add-item                          \
                 --file=${vyatta_sysconfdir}/ips/enable-sid \
                 --value="$VAR(@)"

        if [ "$COMMIT_SIBLING_POSITION" = "LAST" ] || \
           [ "$COMMIT_SIBLING_POSITION" = "FIRSTLAST" ] ; then
           sudo ${vyatta_sbindir}/vyatta-modify-sids.pl            \
                --action=update-rules                              \
                --ruledir=/etc/snort/rules                         \
                --disablefile=${vyatta_sysconfdir}/ips/disable-sid \
                --enablefile=${vyatta_sysconfdir}/ips/enable-sid 
           sudo ${vyatta_sbindir}/vyatta-modify-sids.pl            \
                --action=update-preproc-rules                      \
                --ruledir=/etc/snort/preproc_rules                 \
                --disablefile=${vyatta_sysconfdir}/ips/disable-sid \
                --enablefile=${vyatta_sysconfdir}/ips/enable-sid 
        fi;

delete: sudo ${vyatta_sbindir}/vyatta-modify-sids.pl        \
                 --action=del-item                          \
                 --file=${vyatta_sysconfdir}/ips/enable-sid \
                 --value="$VAR(@)"
        sudo ${vyatta_sbindir}/vyatta-modify-sids.pl         \
                 --action=add-item                           \
                 --file=${vyatta_sysconfdir}/ips/disable-sid \
                 --value="$VAR(@)"

        sudo ${vyatta_sbindir}/vyatta-modify-sids.pl                \
                 --action=update-rules                              \
                 --ruledir=/etc/snort/rules                         \
                 --disablefile=${vyatta_sysconfdir}/ips/disable-sid \
                 --enablefile=${vyatta_sysconfdir}/ips/enable-sid 
        sudo ${vyatta_sbindir}/vyatta-modify-sids.pl                \
                 --action=update-preproc-rules                      \
                 --ruledir=/etc/snort/preproc_rules                 \
                 --disablefile=${vyatta_sysconfdir}/ips/disable-sid \
                 --enablefile=${vyatta_sysconfdir}/ips/enable-sid 
        fi;
        sudo ${vyatta_sbindir}/vyatta-modify-sids.pl         \
                 --action=del-item                           \
                 --file=${vyatta_sysconfdir}/ips/disable-sid \
                 --value="$VAR(@)"
